\section{Introduction}

The gene expression data from nearly 50 tissues across more than 500 post-mortem donor individuals from Genotype Tissue Expression (GTEx) project has proved to be a valuable resource for understanding tissue-specific and tissue-shared genetic architecture\cite{gtex2015, gtex2017, dey2017, aguet2019}. Here we are interested in one specific aspect of tissue-shared gene regulation: the correlation and partial correlation in gene expression for  different tissue pairs based on individual donor level data.  A major challenge in this context is the extensive amount of missing entries in gene expression data---each donor contributes only a subset of tissues for sequencing. 
Common imputation based methods do not work well here as reported in ref.\cite{dey2019}, owing to stringent assumptions about missing entries being close to some central tendency (median) or adhering to some low-dimensional representation of the observed entries\cite{mazumder2010spectral,mazumder2015}. Popular shrinkage and/or sparse correlation or partial correlation estimators such as \textit{corpcor}\cite{ledoit2003improved,schafer2005shrinkage}, GLASSO\cite{friedman2008} or CLIME\cite{cai2011} are not designed for data with missing values. 

%\textcolor{red}{Partial covariance/correlation is used interchanegably -- needs to be fixed.}

A recently proposed approach, \CorShrink{}\cite{dey2019}, co-authored by one of the authors (Dey), does account for this missing information through adaptive shrinkage\cite{stephens2016} of correlations. \CorShrink{} does not guarantee a positive semidefinite (PSD) matrix as part of its EM-based framework, and necessitates a post-hoc modification to ensure a PSD correlation matrix. Also, \CorShrink{} does not extend to conditional graph or partial correlation estimation. Here, we propose a new approach based on convex optimization, called \Robocov{}---this applies for both covariance and inverse covariance matrix estimation in the presence of missing data under the following regularization principles:
\begin{itemize}
    \item the covariance matrix is sparse (i.e., has a few nonzero entries)
    \item inverse covariance matrix is sparse. 
\end{itemize}
\Robocov{} does not \emph{impute} missing values per-se\footnote{Expectation Maximization (EM)\cite{Dempster1977} methods are often used for estimation with missing values, but (i) they depend upon probabilistic modeling assumptions on the data; and (ii) they lead to highly nonconvex problems
posing computational challenges.}---it directly estimates the covariance or inverse covariance matrices in the presence of missing values. To handle missing values, we consider a loss function that depends upon the pairwise covariance terms (computed based on the observed samples) but incorporates an adjustment
%optimize an objective function that considers an adjusted loss function (under mild probability distributional assumptions) 
to guard against our lack of knowledge regarding the missing observations. 
%For covariance estimation, this leads to a loss function (or data fidelity term) that accounts for the error in estimating 
%the pairwise sample covariances (computed based on the observed entries) 
%due to the presence of missing values.
For inverse covariance estimation, \Robocov{} uses a robust optimization based approach~\cite{ben2009robust,bertsimas2011theory} that accounts for the uncertainty in estimating the pairwise sample covariance terms (due to the presence of missing values). Interestingly, both lead to convex optimization formulations that are amenable to modern optimization techniques~\cite{BV2004}---they are scalable to moderate-large scale instances; and unlike conventional EM methods (that lead to highly nonconvex optimization tasks), our estimators are guaranteed to reach the optimal solution of the optimization formulations that define the 
\Robocov{} estimators. 
%not adversely affected by being trapped in sub-optimal local solutions --- a shortcoming of non-convex optimization based estimation procedures such as the EM algorithm\cite{Dempster1977}.

Our simulation experiments suggest that \Robocov{} estimators for correlation and partial correlation matrices have a lower false positive rate compared to competing approaches when data has missing entries.  When applied to the GTEx gene expression data comprising of $\sim70\%$ missing data, \Robocov{} produces less cluttered and highly interpretable visualization of correlation and conditional graph architecture, compared to standard approaches. 

From a biological perspective, a gene with high correlation in expression across many tissue pairs is potentially reflective of systemic biological processes affecting many tissues and organs. To this end, we prioritize genes based on the average \Robocov{} estimated correlation (partial correlation) across all tissue-pairs; we call them  \Robospan{} (\pRobospan{}) genes. A pathway enrichment analysis of  \Robospan{} (\pRobospan{}) genes showed enrichment in systemic functional pathways such as interferon signaling, heat stress factors, circadian clock and more importantly, the immune system. Subsequently we generated SNP level annotations for SNPs linked to \Robospan{} (\pRobospan{}) genes and tested for autoimmune disease informativeness by applying Stratified LD-score regression (S-LDSC) to 11 common blood-related traits (5 autoimmune diseases and 6 blood cell traits; average $N$=306K), conditional on a broad set of coding, conserved, regulatory and LD-related annotations. \Robospan{} and \pRobospan{} genes showed high disease informativeness for blood and autoimmune diseases and traits; in comparison; the analogously defined \Corspan{} genes 
defined using the standard correlation estimator was non-informative. This highlights the biological and disease-level significance of our work.

In Section~\ref{sec:methods-materials}, we present an overview of methods and the underlying optimization framework for \Robocov{}. Section~\ref{sec:results} presents the simulation results and the application of \Robocov{} to GTEx gene expression data and the downstream application of \Robocov{} in understanding the autoimmune disease architecture. Finally, Section~\ref{sec:discussion} presents an overall summary and future directions. 

